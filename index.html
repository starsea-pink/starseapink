<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>æ‚¶é¨·ç”Ÿæ—¥ç•™è¨€ç‰†</title>
  <style>
    body {
      font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
      background-color: #fdf6e3;
      padding: 20px;
      text-align: center;
    }

    .message {
      display: inline-block;
      margin: 10px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .message:hover {
      transform: scale(1.05);
    }

    .character {
      width: 120px;
      height: auto;
      border-radius: 12px;
    }

    .text-box {
      background-color: #fff;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 200px;
      text-align: left;
      font-size: 14px;
    }

    .timestamp {
      display: block;
      margin-top: 6px;
      font-size: 12px;
      color: #888;
    }

    h1 {
      color: #d2691e;
    }
  </style>
</head>
<body>
  <h1>ğŸ‚ æ‚¶é¨·ç”Ÿæ—¥ç•™è¨€ç‰† ğŸ‰</h1>
  <p>é»è§’è‰²å¯ä»¥çœ‹åˆ°ç•™è¨€å…§å®¹ã€ç¥ç¦èˆ‡åˆ‡æ›åœ–ç‰‡å”·ï¼</p>
  <div id="app"></div>

  <script>
    // è‡ªå‹•è¼‰å…¥ Google è¡¨å–®ç•™è¨€
    fetch("https://opensheet.elk.sh/1LxjyMv1NWGElQQKoNvSrkoCS1nmZlQhhEeuebZ0uTcg/Form%20Responses%201")
      .then((res) => res.json())
      .then((data) => {
        data.forEach(entry => {
          const name = entry["æ‚¨çš„æš±ç¨±"]?.trim() || "åŒ¿å";
          const message = entry["æƒ³å°å£½æ˜Ÿèªªçš„æ‚„æ‚„è©±"]?.trim() || "";
          const avatarKey = entry["ä½ é¸çš„è§’è‰²"] || "Luffy";
          const timestamp = entry["æ™‚é–“æˆ³è¨˜"];

          const avatarUrl = getAvatarUrl(avatarKey, name);

          const messageHTML = `
            <div class="message cycle" data-step="0" data-name="${name}" data-message="${message}" data-time="${timestamp}" data-avatar="${avatarKey}">
              <img class="character" src="${avatarUrl}" alt="è§’è‰²" />
            </div>
          `;
          document.getElementById("app").insertAdjacentHTML("beforeend", messageHTML);
        });
      });

    // é»è§’è‰²åˆ‡æ›é¡¯ç¤º
    document.addEventListener("click", function (e) {
      const msg = e.target.closest(".message.cycle");
      if (!msg) return;

      let step = parseInt(msg.getAttribute("data-step"), 10);
      const name = msg.getAttribute("data-name");
      const message = msg.getAttribute("data-message");
      const time = msg.getAttribute("data-time");
      const avatarKey = msg.getAttribute("data-avatar") || "Luffy";

      if (step === 0) {
        msg.innerHTML = `<div class="text-box">${name}ï¼š${message}<br><span class="timestamp">${time}</span></div>`;
      } else if (step === 1) {
        msg.innerHTML = `<div class="text-box">${getRandomHBD()}<br><span class="timestamp">${time}</span></div>`;
      } else {
        const avatarUrl = getAvatarUrl(avatarKey, name);
        msg.innerHTML = `<img class="character" src="${avatarUrl}" alt="è§’è‰²" />`;
        step = -1;
      }

      msg.setAttribute("data-step", step + 1);
    });

    function getAvatarUrl(key, name = "") {
      if (key === "Special" && name !== "å°å±è‚¡è›‹") {
        return 'images/Luffy.png'; // é¿å…æ¿«ç”¨å°ˆå±¬è§’è‰²
      }
      const map = {
        Luffy: 'images/Luffy.png',
        Nami: 'images/Nami.png',
        Robin: 'images/Robin.png',
        Hancock: 'images/Hancock.png',
        Sanji: 'images/Sanji.png',
        Zoro: 'images/Zoro.png',
        beauty1: 'images/beauty1.png',
        beauty2: 'images/beauty2.png',
        Special: 'images/special.png'
      };
      return map[key] || map.Luffy;
    }

    function getRandomHBD() {
      const list = [
         "é¡˜ä½ å¤©å¤©é–‹å¿ƒğŸ‰ï¼ è¨˜å¾—æ¯å¤©éƒ½è¦ç¬‘ä¸€ä¸‹ï¼",
  "ä½ æœ€æ£’ï¼ä»Šå¤©ä¹Ÿè¦å¹¸ç¦å–”ï¼",
  "å¸Œæœ›ä½ çš„äººç”Ÿåƒèˆªæµ·ç‹ä¸€æ¨£ç²¾å½©ï¼",
  "ç¥ä½ ä¸€æ•´å¹´éƒ½åƒé­¯å¤«åƒåˆ°è‚‰ä¸€æ¨£å¿«æ¨‚ï¼",
  "é¡˜ä½ å¤©å¤©ç¬‘å¾—åƒé­¯å¤«ä¸€æ¨£é–‹æ‡·ï¼",
  "ç¥ä½ åƒç´¢éš†ä¸€æ¨£å …å®šå‹‡æ•¢ï¼",
  "å¸Œæœ›ä½ æ¯å¤©éƒ½èƒ½åƒå¨œç¾æ•¸éŒ¢ä¸€æ¨£å¿«æ¨‚ï½",
  "äººç”Ÿå°±è©²åƒä½›æœ—åŸºä¸€æ¨£è¶…ï½ç´šï½ï¼",
  "ç¥ä½ é­…åŠ›çˆ†æ£šï¼Œåƒç¾…è³“ä¸€æ¨£å„ªé›…ç¥ç§˜ï½",
  "åˆ¥å¿˜äº†ä¼‘æ¯ï¼Œåƒå–¬å·´ä¸€æ¨£å¯æ„›ç™‚ç™’ï¼",
  "æ¯å¤©éƒ½è¦è®šç¾è‡ªå·±ï¼Œåƒå¥³å¸ä¸€æ¨£è‡ªä¿¡æ»¿æ»¿ï¼",
  "åƒé¦™å‰å£«ä¸€æ¨£æš–å¿ƒåœ°å¯µæ„›ç”Ÿæ´»å§ï½",
  "æ‚¶é¨·ä¹Ÿå¯ä»¥å¾ˆå¿«æ¨‚ï¼",
  "ç¥ä½ æœªä¾†ä¸€å¹´éƒ½æ¯”å»å¹´çš„ä»Šå¤©æ›´æ£’ï¼",
  "è¨˜å¾—ï¼Œæ¯ä¸€å¤©éƒ½å€¼å¾—æ…¶ç¥ï½",
  "ç¥ä½ å¿«æ¨‚å¦‚å–¬å·´ï¼Œå‹‡æ•¢å¦‚ç´¢éš†ï¼",
  "ç¥ä½ èº«é«”å¥åº·ï¼",
  "å¸Œæœ›ä½ å¿ƒæƒ³äº‹æˆï¼",
  "æ¯å¤©éƒ½è¢«å¹¸ç¦åŒ…åœï¼",
  "ç¥ä½ æ“æœ‰é¦™å‰å£«çš„ç¾é£Ÿèˆ‡ç¾…è³“çš„æ™ºæ…§ï¼",
  "é¡˜ä½ æ¯ä¸€å¤©éƒ½å……æ»¿ç¬‘å®¹ ğŸ˜„",
  "ç¥ä½ å¿ƒæƒ³äº‹æˆï¼Œå¹¸ç¦ç¾æ»¿ âœ¨",
  "æœªä¾†ä¸€å¹´é †é †åˆ©åˆ© ğŸ€",
  "é¡˜ä½ å¤©å¤©éƒ½åƒä»Šå¤©ä¸€æ¨£å¿«æ¨‚ ğŸ¥³",
  "å¸Œæœ›ä½ æœªä¾†ä¸€å¹´éƒ½é †é †åˆ©åˆ©ï¼",
  "èº«é«”å¥åº·ï¼Œå¹³å®‰å¿«æ¨‚ï¼",
  "ç¥ä½ è¢«å¥½å¤šå¥½äº‹ç ¸ä¸­ï¼",
  "æ¯å¤©éƒ½å……æ»¿é©šå–œèˆ‡æ„›ï¼",
  "å¸Œæœ›ä½ æ¯å¤©éƒ½èƒ½åƒå¨œç¾æ•¸éŒ¢ä¸€æ¨£å¿«æ¨‚ï½",
  "é¡˜ä½ å¤©å¤©éƒ½æœ‰å¥½å¿ƒæƒ…ï¼",
  "è’Ÿè’»ä¿¡ä¹Ÿå·å·ç¥ç¦ä½ ï½",
      ];
      return list[Math.floor(Math.random() * list.length)];
    }
  </script>
</body>
</html>